<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RaNNC (Rapid Neural Network Connector) &mdash; RaNNC 0.7.0rc1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> RaNNC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">API references</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">RaNNC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>RaNNC (Rapid Neural Network Connector)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rannc-rapid-neural-network-connector">
<h1>RaNNC (Rapid Neural Network Connector)<a class="headerlink" href="#rannc-rapid-neural-network-connector" title="Permalink to this headline"></a></h1>
<p>RaNNC is an automatic parallelization middleware for training very large-scale neural networks.
Since modern networks often have billions of parameters, they do not fit the memory of GPUs.
RaNNC automatically partitions such a huge network with model parallelism and computes it using multiple GPUs.</p>
<p>Compared to existing frameworks, including <a class="reference external" href="https://github.com/NVIDIA/Megatron-LM">Megatron-LM</a> and
<a class="reference external" href="https://github.com/tensorflow/mesh">Mesh-TensorFlow</a>,
which require users to implement partitioning of the given network, RaNNC automatically partitions
a network for PyTorch without any modification to its description.
In addition, RaNNC basically has no limitation on its network architecture while the existing frameworks are only applicable to transformer-based networks.</p>
<p>The code below shows a simple usage of RaNNC.
You only need to insert the line highlighted below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>                  <span class="c1"># Define a network</span>
<span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">))</span> <span class="c1"># Move paramsters to a cuda device</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span> <span class="c1"># Define an optimizer</span>
<span class="hll"><span class="n">model</span> <span class="o">=</span> <span class="n">pyrannc</span><span class="o">.</span><span class="n">RaNNCModule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span>  <span class="c1">##### Wrap by RaNNCModule #####</span>
</span><span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>            <span class="c1"># Run a forward pass</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>                <span class="c1"># Run a backward pass</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>               <span class="c1"># Update parameters</span>
</pre></div>
</div>
<p>Models used with RaNNC (<code class="docutils literal notranslate"><span class="pre">Net</span></code> in the above example) do not need special operators for distributed computation or annotations for partitioning
(See our examples:
<a class="reference external" href="https://github.com/nict-wisdom/rannc/blob/main/examples/tutorial.py">model for the tutorial</a>,
enlarged versions of <a class="reference external" href="https://github.com/nict-wisdom/rannc-examples/blob/main/bert/modeling.py">BERT</a> and
<a class="reference external" href="https://github.com/nict-wisdom/rannc-examples/blob/main/resnet/resnet_wf.py">ResNet</a>).
RaNNC automatically partitions a model to <cite>subcomponents</cite> so that each subcomponent fits to the GPU memory and a high
training throughput is achieved.</p>
<p>In contrast, for example, Megatron-LM needs special operators like <code class="docutils literal notranslate"><span class="pre">ColumnParallelLinear</span></code> and  <code class="docutils literal notranslate"><span class="pre">RowParallelLinear</span></code>
(See an <a class="reference external" href="https://github.com/NVIDIA/Megatron-LM/blob/b31e1296354e979722627a6c4dedafe19b51fa97/megatron/model/transformer.py#L59">example</a> in Transformer).
Implementing a model using such operators is very hard even for experts because the user needs to consider computational loads
of the model, memory usages, and communication overheads.
In addition, some existing frameworks including Megatron-LM can be applicable only to Transformer family networks.</p>
<p>We confirmed that RaNNC can train a BERT model with approximately 100 billion parameters without a manual
modification/optimization of the definition of the network for model partitioning.</p>
<p>The initial ideas of RaNNC were published at IPDPS 2021.
See our paper <a class="footnote-reference brackets" href="#f1" id="id1">1</a> for RaNNC’s partitioning algorithm and performance comparisons with other frameworks (<a class="reference external" href="http://arxiv.org/abs/2103.16063">preprint</a>).</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">API references</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building from source</a></li>
</ul>
</div>
</section>
<section id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline"></a></h1>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Automatic Graph Partitioning for Very Large-scale Deep Learning, Masahiro Tanaka, Kenjiro Taura, Toshihiro Hanawa and Kentaro Torisawa, In the Proceedings of 35th IEEE International Parallel and Distributed Processing Symposium (IPDPS 2021), pp. 1004-1013, May, 2021.</p>
</dd>
</dl>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Data-driven Intelligent System Research Center (DIRECT), National Institute of Information and Communications Technology (NICT).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>